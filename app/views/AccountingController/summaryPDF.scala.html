@(year: Int, recipePages: List[ParentCategoryList], recipeTreasuries: List[Treasury], expensePages: List[ParentCategoryList], expenseTreasuries: List[Treasury])
@import utils.DateUtils
@import utils.CurrencyUtils
@import play.i18n._
<!DOCTYPE html>
<html>
    <head>
        <title></title>
        <link rel="stylesheet" type="text/css" media="print" href="/public/stylesheets/print.css">
    </head>
    <body class="page-landscape">
        <div class="page-footer"><span class="page-current">&nbsp;</span>/<span class="page-count">&nbsp;</span></div>

        <div class="page-header">@Messages.get("summary.header.recipe") @year</div>
        @for((page,i) <- recipePages.zipWithIndex){
            <table class="recipe">
                <thead>
                    <tr>
                        <th rowspan="2" class="month-column">@Messages.get("accountingSummary.month")</th>
                        @if(i == 0){
                            <th colspan="@{recipeTreasuries.size}" class="rowTreasury">@Messages.get("accountingRow.treasury")</th>
                        }
                        @for(parentCategory:Category <- page) {
                            @if(parentCategory.hasChildren){
                                <th colspan="@parentCategory.children.size()" class="rowCategory">@{parentCategory.name}</th>
                            }else{
                                <th rowspan="2" class="category-column">@{parentCategory.name}</th>
                            }
                        }
                    </tr>
                    <tr>
                        @if(i == 0){
                            @for(treasury <- recipeTreasuries) {
                                <th class="treasury-column">@{treasury.name}</th>
                            }
                        }
                        @for(childrenCategory:Category <- page.getChildren) {
                            <th class="category-column">@{childrenCategory.name}</th>
                        }
                    </tr>
                </thead>
                <tfoot>
                    <tr class="important">
                        <td>@Messages.get("accounting.fromJanuarySum")</td>
                        @if(i == 0){
                            @for(treasury <- recipeTreasuries) {
                                <td class="numeric">@CurrencyUtils.format(treasury.fromJanuarySum(year, 12))</td>
                            }
                        }
                        @for(leafCategory:Category <- page.getLeafs()) {
                            <td class="numeric">@CurrencyUtils.format(leafCategory.fromJanuarySum(year, 12))</td>
                        }
                    </tr>
                </tfoot>
                <tbody>
                @for(month <- 1 to 12) {
                    <tr class="accounting-row">
                        <td class="capitalize">@DateUtils.month(month)</td>
                        @if(i == 0){
                            @for(treasury <- recipeTreasuries) {
                                <td class="numeric">
                                @defining(treasury.monthSum(year, month)) { monthSum =>
                                    @if(monthSum.doubleValue() != 0){@CurrencyUtils.format(monthSum)}
                                }
                                </td>
                            }
                        }
                        @for(leafCategory:Category <- page.getLeafs()) {
                            <td class="numeric">
                            @defining(leafCategory.monthSum(year, month)) { monthSum =>
                                @if(monthSum.doubleValue() != 0){@CurrencyUtils.format(monthSum)}
                            }
                            </td>
                        }
                    </tr>
                }
                </tbody>
            </table>
            <div class="page-break">&nbsp;</div>
        }
        <div class="page-header">@Messages.get("summary.header.expense") @year</div>
        @for((page,i) <- expensePages.zipWithIndex){
            <table class="expense">
                <thead>
                    <tr>
                        <th rowspan="2" class="month-column">@Messages.get("accountingSummary.month")</th>
                        @if(i == 0){
                            <th colspan="@{expenseTreasuries.size}" class="rowTreasury">@Messages.get("accountingRow.treasury")</th>
                            <th rowspan="2" class="category-column">@Messages.get("accountingRow.personalWithdrawals")</th>
                        }
                        @for(parentCategory:Category <- page) {
                            @if(parentCategory.hasChildren){
                            <th colspan="@parentCategory.children.size()" class="rowCategory">@{parentCategory.name}</th>
                            }else{
                            <th rowspan="2" class="category-column">@{parentCategory.name}</th>
                            }
                        }
                    </tr>
                    <tr>
                        @if(i == 0){
                            @for(treasury <- expenseTreasuries) {
                                <th class="treasury-column">@{treasury.name}</th>
                            }
                        }
                        @for(childrenCategory:Category <- page.getChildren) {
                            <th class="category-column">@{childrenCategory.name}</th>
                        }
                    </tr>
                </thead>
                <tfoot>
                    <tr class="important">
                        <td>@Messages.get("accounting.fromJanuarySum")</td>
                        @if(i == 0){
                            @for(treasury <- expenseTreasuries) {
                                <td class="numeric">@CurrencyUtils.format(treasury.fromJanuarySum(year, 12))</td>
                            }
                            <td class="numeric">@CurrencyUtils.format(Accounting.personalWithdrawalFromJanuarySum(year, 12))</td>
                        }
                        @for(leafCategory:Category <- page.getLeafs()) {
                            <td class="numeric">@CurrencyUtils.format(leafCategory.fromJanuarySum(year, 12))</td>
                        }
                    </tr>
                </tfoot>
                <tbody>
                    @for(month <- 1 to 12) {
                        <tr class="accounting-row">
                            <td class="capitalize">@DateUtils.month(month)</td>
                            @if(i == 0){
                                @for(treasury <- expenseTreasuries) {
                                    <td class="numeric">
                                        @defining(treasury.monthSum(year, month)) { monthSum =>
                                            @if(monthSum.doubleValue() != 0){@CurrencyUtils.format(monthSum)}
                                        }
                                    </td>
                                }
                                <td class="numeric">
                                    @defining(Accounting.personalWithdrawalMonthSum(year, month)) { monthSum =>
                                        @if(monthSum.doubleValue() != 0){@CurrencyUtils.format(monthSum)}
                                    }
                                </td>
                            }
                            @for(leafCategory:Category <- page.getLeafs()) {
                                <td class="numeric">
                                    @defining(leafCategory.monthSum(year, month)) { monthSum =>
                                        @if(monthSum.doubleValue() != 0){@CurrencyUtils.format(monthSum)}
                                    }
                                </td>
                            }
                        </tr>
                    }
                </tbody>
            </table>
            <div class="page-break">&nbsp;</div>
        }
    </body>
</html>