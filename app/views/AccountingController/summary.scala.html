@(rowType: String, year: Int, parentCategories: List[Category], childrenCategories: List[Category], leafCategories: List[Category], treasuries: List[Treasury])
@import utils.DateUtils
@import utils.CurrencyUtils
@import play.i18n._

@views.html.AccountingController.accounting(rowType, year, 0) {
    <table class="table table-bordered table-striped table-hover accounting @rowType">
        <thead>
            <tr>
                <th rowspan="2" class="month-column">@Messages.get("accountingSummary.month")</th>
                <th colspan="@{treasuries.size}" class="rowTreasury">@Messages.get("accountingRow.treasury")</th>
                @if(ERowType.value(rowType) == ERowType.EXPENSE){
                    <th rowspan="2" class="category-column">@Messages.get("accountingRow.personalWithdrawals")</th>
                }
                @for(parentCategory <- parentCategories) {
                    @if(parentCategory.hasChildren){
                        <th colspan="@parentCategory.children.size()" class="rowCategory">@{parentCategory.name}</th>
                    }else{
                        <th rowspan="2" class="category-column">@{parentCategory.name}</th>
                    }
                }
            </tr>
            <tr>
                @for(treasury <- treasuries) {
                    <th class="treasury-column">@{treasury.name}</th>
                }
                @for(childrenCategory <- childrenCategories) {
                    <th class="category-column">@{childrenCategory.name}</th>
                }
            </tr>
        </thead>
        <tfoot>
            <tr class="important">
                <td>@Messages.get("accounting.fromJanuarySum")</td>
                @for(treasury <- treasuries) {
                    <td class="numeric">@CurrencyUtils.format(treasury.fromJanuarySum(year, 12))</td>
                }
                @if(ERowType.value(rowType) == ERowType.EXPENSE){
                    <td class="numeric">@CurrencyUtils.format(Accounting.personalWithdrawalFromJanuarySum(year, 12))</td>
                }
                @for(leafCategory <- leafCategories) {
                    <td class="numeric">@CurrencyUtils.format(leafCategory.fromJanuarySum(year, 12))</td>
                }
            </tr>
        </tfoot>
        <tbody>
            @for(month <- 1 to 12) {
                <tr class="accounting-row">
                    <td class="capitalize"><a href="@routes.AccountingController.byMonth(rowType, year, month)">@DateUtils.month(month)</a></td>
                    @for(treasury <- treasuries) {
                        <td class="numeric">
                            @defining(treasury.monthSum(year, month)) { monthSum =>
                                @if(monthSum>0){@CurrencyUtils.format(monthSum)}
                            }
                        </td>
                    }
                    @if(ERowType.value(rowType) == ERowType.EXPENSE){
                        <td class="numeric">
                            @defining(Accounting.personalWithdrawalMonthSum(year, month)) { monthSum =>
                                @if(monthSum>0){@CurrencyUtils.format(monthSum)}
                            }
                        </td>
                    }
                    @for(leafCategory <- leafCategories) {
                        <td class="numeric">
                            @defining(leafCategory.monthSum(year, month)) { monthSum =>
                                @if(monthSum>0){@CurrencyUtils.format(monthSum)}
                            }
                        </td>
                    }
                </tr>
            }
        </tbody>
    </table>
}